(function(d,u){d.ui=d.ui||{};var m=/left|center|right/,n=/top|center|bottom/,q=d.fn.position,r=d.fn.offset;d.fn.position=function(b){if(!b||!b.of)return q.apply(this,arguments);b=d.extend({},b);var a=d(b.of),c=a[0],g=(b.collision||"flip").split(" "),f=b.offset?b.offset.split(" "):[0,0],k,l,e;9===c.nodeType?(k=a.width(),l=a.height(),e={top:0,left:0}):c.setTimeout?(k=a.width(),l=a.height(),e={top:a.scrollTop(),left:a.scrollLeft()}):c.preventDefault?(b.at="left top",k=l=0,e={top:b.of.pageY,left:b.of.pageX}):
(k=a.outerWidth(),l=a.outerHeight(),e=a.offset());d.each(["my","at"],function(){var a=(b[this]||"").split(" ");1===a.length&&(a=m.test(a[0])?a.concat(["center"]):n.test(a[0])?["center"].concat(a):["center","center"]);a[0]=m.test(a[0])?a[0]:"center";a[1]=n.test(a[1])?a[1]:"center";b[this]=a});1===g.length&&(g[1]=g[0]);f[0]=parseInt(f[0],10)||0;1===f.length&&(f[1]=f[0]);f[1]=parseInt(f[1],10)||0;"right"===b.at[0]?e.left+=k:"center"===b.at[0]&&(e.left+=k/2);"bottom"===b.at[1]?e.top+=l:"center"===b.at[1]&&
(e.top+=l/2);e.left+=f[0];e.top+=f[1];return this.each(function(){var a=d(this),c=a.outerWidth(),p=a.outerHeight(),m=parseInt(d.curCSS(this,"marginLeft",!0))||0,n=parseInt(d.curCSS(this,"marginTop",!0))||0,q=c+m+(parseInt(d.curCSS(this,"marginRight",!0))||0),r=p+n+(parseInt(d.curCSS(this,"marginBottom",!0))||0),h=d.extend({},e),t;"right"===b.my[0]?h.left-=c:"center"===b.my[0]&&(h.left-=c/2);"bottom"===b.my[1]?h.top-=p:"center"===b.my[1]&&(h.top-=p/2);h.left=Math.round(h.left);h.top=Math.round(h.top);
t={left:h.left-m,top:h.top-n};d.each(["left","top"],function(a,e){if(d.ui.position[g[a]])d.ui.position[g[a]][e](h,{targetWidth:k,targetHeight:l,elemWidth:c,elemHeight:p,collisionPosition:t,collisionWidth:q,collisionHeight:r,offset:f,my:b.my,at:b.at})});d.fn.bgiframe&&a.bgiframe();a.offset(d.extend(h,{using:b.using}))})};d.ui.position={fit:{left:function(b,a){var c=d(window),c=a.collisionPosition.left+a.collisionWidth-c.width()-c.scrollLeft();b.left=0<c?b.left-c:Math.max(b.left-a.collisionPosition.left,
b.left)},top:function(b,a){var c=d(window),c=a.collisionPosition.top+a.collisionHeight-c.height()-c.scrollTop();b.top=0<c?b.top-c:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if("center"!==a.at[0]){var c=d(window),c=a.collisionPosition.left+a.collisionWidth-c.width()-c.scrollLeft(),g="left"===a.my[0]?-a.elemWidth:"right"===a.my[0]?a.elemWidth:0,f="left"===a.at[0]?a.targetWidth:-a.targetWidth,k=-2*a.offset[0];b.left+=0>a.collisionPosition.left?g+f+k:0<c?g+f+k:0}},top:function(b,
a){if("center"!==a.at[1]){var c=d(window),c=a.collisionPosition.top+a.collisionHeight-c.height()-c.scrollTop(),g="top"===a.my[1]?-a.elemHeight:"bottom"===a.my[1]?a.elemHeight:0,f="top"===a.at[1]?a.targetHeight:-a.targetHeight,k=-2*a.offset[1];b.top+=0>a.collisionPosition.top?g+f+k:0<c?g+f+k:0}}}};d.offset.setOffset||(d.offset.setOffset=function(b,a){/static/.test(d.curCSS(b,"position"))&&(b.style.position="relative");var c=d(b),g=c.offset(),f=parseInt(d.curCSS(b,"top",!0),10)||0,k=parseInt(d.curCSS(b,
"left",!0),10)||0,g={top:a.top-g.top+f,left:a.left-g.left+k};"using"in a?a.using.call(b,g):c.css(g)},d.fn.offset=function(b){var a=this[0];return a&&a.ownerDocument?b?this.each(function(){d.offset.setOffset(this,b)}):r.call(this):null})})(jQuery);
